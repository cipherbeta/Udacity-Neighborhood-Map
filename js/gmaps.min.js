var viewModel={self:this,markers:ko.observableArray([{title:"White Spruce Inn",location:{lat:45.920036,lng:-89.253894,address:"419 N. Railroad St, Eagle River, WI"},placeID:"ChIJvyJyzMk3VE0RyBj7sxv6nuI",content:"Whether you just want to stop by for a few appetizers amongst friends, grab a quick lunch with a co-worker, or enjoy a full meal with family, Eddie Bâ€™s White Spruce Restaurant & Tavern will deliver excellent food and drink to you every time.",zomatoID:"17690788"},{title:"Alexander's Family Pizza",location:{lat:45.91491,lng:-89.251605,address:"211 S Railroad St, Eagle River, WI"},placeID:"ChIJmyJp8sg3VE0RsckvMA8qkho",content:"The classic family-oriented arcade and pizza joint. Come on by for arcade games, shooting some pool, or just hanging out!",zomatoID:"17686025"},{title:"Riverstone Restaurant and Tavern",location:{lat:45.918378,lng:-89.252927,address:"219 N Railroad St, Eagle River, WI"},placeID:"ChIJfcY38sg3VE0RWKNqVFR5EuQ",content:"Welcome to Riverstone Restaurant & Tavern! Come as you are and enjoy anything from fresh made artisan hearth breads to from-scratch pizza to wild alaskan salmon! Ron and Cindy Meinholz, Owners South of the bridge, in historic downtown Eagle River, and... Home of Riverstone Catering!",zomatoID:"17686059"},{title:"Butch's Pizza",location:{lat:45.915167,lng:-89.249773,address:"220 E Wall St, Eagle River, WI"},placeID:"ChIJ225_Uc83VE0R7b8Bb1g4o1U",content:"Butch's is the finest pizzeria in the Northwoods of Wisconsin. We are proud to offer our famous thin crust and hand tossed pizza, entirely homemade, prepared in small batches from the finest ingredients. Our dough and sauce are secret recipes, developed over 40 years ago and mixed from scratch daily with only the finest ingredients. So you choose yur favorite toppings and we will prepare your pie to order, never skimping on toppings and finishing it off with 100% mozzarella cheese. Butch's pizza never uses fillers in the cheese, sauce or dough, so enjoy a truly homemade pizza and taste the difference.",zomatoID:"17686031"},{title:"Soda Pops Restaurant",location:{lat:45.915735,lng:-89.251947,address:"125 S Railroad St, Eagle River, WI"},placeID:"ChIJTV1AVM83VE0RAPYSiLK2AD4",content:"Welcome to Riverstone Restaurant & Tavern! Come as you are and enjoy anything from fresh made artisan hearth breads to from-scratch pizza to wild alaskan salmon! Ron and Cindy Meinholz, Owners South of the bridge, in historic downtown Eagle River, and... Home of Riverstone Catering!",zomatoID:"17686062"}]),menuIsOpen:ko.observable(false),autoNavigation:function(){if(viewModel.menuIsOpen()===false){viewModel.openNavigation()}else{viewModel.closeNavigation()}},openNavigation:function(){$("#sideNav").css("marginLeft","0");$("#tapControls").css("marginLeft","16em");viewModel.menuIsOpen(true)},closeNavigation:function(){$("#sideNav").css("marginLeft","-16em");$("#tapControls").css("marginLeft","0");viewModel.menuIsOpen(false)},hideNavControls:function(){$("#tapControls").css("left","-2em");$("#navControlsLink").css("left","-1em")},showNavControls:function(){$("#tapControls").css("left","0");$("#navControlsLink").css("left","0")},gMarkers:ko.observableArray([]),userQuery:ko.observable(),toClicked:ko.observable({}),logClick:function(a){viewModel.toClicked(a);console.log(a);map.setCenter(a.getPosition());map.setZoom(16);google.maps.event.trigger(a,"click");viewModel.toClicked().setAnimation(google.maps.Animation.DROP);return viewModel.toClicked()},searchResults:ko.pureComputed(function(){var c=viewModel.gMarkers();var b=viewModel.userQuery();var a=viewModel.gMarkers().filter(function(e){var d=e.title.toLowerCase().indexOf(b)>=0;return d});setMapOnAll(null);if(!viewModel.userQuery()){setMapOnAll(map)}else{for(i=0;i<a.length;i++){a[i].setMap(map)}}return a})};$(document).ready(function(){console.log("Ready!");$("#loaderDiv").css("opacity","0");$("#loaderDiv").remove();$(".locationList").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$("#helpButton").on("click",function(){$("#longHelpWindow").css("left","0");$("#helpButton").css("opacity","0");viewModel.hideNavControls();viewModel.closeNavigation()});$("#longHelp_goBack").on("click",function(){$("#longHelpWindow").css("left","100%");$("#helpButton").css("opacity","100");viewModel.showNavControls()});$(".resultOPEN").on("click",function(){$("#longInfoWindow").css("right","0");$("#helpButton").css("opacity","0");viewModel.hideNavControls();viewModel.closeNavigation()});$("#longInfo_goBack").on("click",function(){$("#longInfoWindow").css("right","100%");$("#helpButton").css("opacity","100");viewModel.showNavControls()})});$(document).change(function(){$(".locationList").hover(function(){$(this).addClass("active")},function(){$(this).removeClass("active")});$("#helpButton").on("click",function(){$("#longHelpWindow").css("left","0");$("#helpButton").css("opacity","0");viewModel.closeNavigation()});$("#longHelp_goBack").on("click",function(){$("#longHelpWindow").css("left","100%");$("#helpButton").css("opacity","100")})});var bouncingBall=anime({targets:"#helpButton",rotate:"1turn",loop:false,direction:"alternate",autoplay:true});function toggleBounce(){for(var a=0;a<viewModel.gMarkers().length;a++){viewModel.gMarkers()[a].setAnimation(null)}if(this.getAnimation()!==null){this.setAnimation(null)}else{this.setAnimation(google.maps.Animation.BOUNCE)}}var zomatoGetData=function(b){var c=b.zomatoID;var a=$.ajax({url:"https://developers.zomato.com/api/v2.1/restaurant?res_id="+c,headers:{"user-key":"69acf94ce65eed4a327ab2a853610996"},success:function(d){return d},error:function(d){alert("Looks like we're having some trouble chatting with Zomato. If this persists, please let us know the error shown below and I'll see what I can do. Thanks!"+d)}});console.log("Zomato Data Updated");return a};var validateUndefined=function(a){if(a!==undefined){return a}};var map;var mapsAPIkey="AIzaSyCs-Crx7hPswfS-5yRSMJfHLal7Kbm0aHM";var mapStyle=[{featureType:"all",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"all",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"administrative.locality",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"administrative.neighborhood",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"landscape",elementType:"all",stylers:[{color:"#dcdcdc"}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#e2e3e4"},{visibility:"on"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"},{saturation:"-65"},{lightness:"5"}]},{featureType:"poi.attraction",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",elementType:"geometry",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",elementType:"geometry.fill",stylers:[{visibility:"on"}]},{featureType:"poi.attraction",elementType:"geometry.stroke",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#e2e3e4"}]},{featureType:"poi.school",elementType:"geometry.fill",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"all",stylers:[{saturation:-100},{lightness:45}]},{featureType:"road",elementType:"labels.text",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#fdbf6e"},{visibility:"on"}]},{featureType:"road.highway",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"simplified"},{saturation:"-100"},{gamma:"1"}]},{featureType:"transit",elementType:"geometry",stylers:[{visibility:"simplified"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.text",stylers:[{visibility:"simplified"},{color:"#909090"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit.line",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit.station.rail",elementType:"labels.text",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"all",stylers:[{color:"#c3e1ec"},{visibility:"on"}]}];function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:45.917034,lng:-89.248168},zoom:15,styles:mapStyle,disableDefaultUI:true});var c=new google.maps.InfoWindow();a(map,viewModel.markers());function a(f,k){var h=k;for(b=0;b<h.length;b++){var j=h[b];var n=new google.maps.LatLng(j.location.lat,j.location.lng);var t=j.title;var r=j.location.lat;var s=j.location.lng;var u=j.location.address;var g=j.placeID;var q="https://www.google.com/maps/dir/?api=1&destination="+encodeURIComponent(u)+"&destination_place_id="+g;var o=j.content;var v=j.zomatoID;var p=zomatoGetData(j);var l=new google.maps.Marker({map:f,position:n,title:t,lat:r,lng:s,address:u,directions:q,placeID:g,zomatoID:v,zomatoInfo:p,content:o});l.addListener("click",toggleBounce);e(l);viewModel.gMarkers().push(l)}function e(m){google.maps.event.addListener(m,"click",function(){c.setContent(this.title+"<br>"+this.address+'<br><a target="_blank" href="'+this.directions+'">Get Directions</a><!-- ko if: toClicked().zomatoInfo.responseJSON.user_rating.rating_text --><br>Rated '+this.zomatoInfo.responseJSON.user_rating.aggregate_rating+" out of 5.<br>Serves: "+this.zomatoInfo.responseJSON.cuisines+".<!-- /ko -->");c.open(f,this);f.setCenter(this)})}}var d=new google.maps.LatLngBounds();for(var b=0;b<viewModel.gMarkers().length;b++){d.extend(viewModel.gMarkers()[b].getPosition())}map.fitBounds(d);viewModel.userQuery("")}var setMapOnAll=function(b){for(var a=0;a<viewModel.gMarkers().length;a++){viewModel.gMarkers()[a].setMap(b)}};var mapHasErrors=function(){alert("Looks like we're having some trouble getting to Google Maps. Given the nature of this application, that's, uh.... A problem. Try checking your internet connection and/or firewall/parental blocks. If this still persists, let us know and we'll check it out.")};ko.options.deferUpdates=true;ko.applyBindings(viewModel);